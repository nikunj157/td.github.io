<!DOCTYPE html>
<meta charset="utf-8">
<head>
<title>
Publisher Page
</title>
<script>
  // Test right flags are there.
  const page_body = document.createElement('div');
  text=""
  if (!navigator.runAdAuction) {
    text += "FLEDGE runAdAuction seems to be disabled. Start Chrome with right flags.";
  }
  page_body.innerHTML += text;
  if (document.body) 
  	document.body.appendChild(page_body);
</script>

<script type="module">
async function runAuction() { 
  if (navigator.runAdAuction) {
    const ar = await navigator.runAdAuction({
        seller: 'https://nikunj157.github.io/td.github.io',
        decisionLogicUrl: 'https://nikunj157.github.io/td.github.io/scripts/ssp.js',
        trustedScoringSignalsUrl: 'https://nikunj157.github.io/td.github.io/fake_endpoint',
        interestGroupBuyers: ['https://nikunj157.github.io/td.github.io'],
        auctionSignals: {key: "auction signals"},
        sellerSignals: {key: "seller signals"},
        perBuyerSignals: {"https://nikunj157.github.io/td.github.io": {key: "got the signal"}},
      });
    if (ar === null) {
      const d = document.createElement('div');
      d.innerHTML = "No turtledove winner";
      document.body.appendChild(d);
    } else {
      const iframe = document.createElement('iframe');
      iframe.src = ar;
      document.body.appendChild(iframe);
    }
  }
}
// export run auction
window.runAuction = runAuction;
</script>
</head>
<body>
<h1 id="heading1">Publisher site to execute auction</h1>
<h3>Please enter following Auction parameters & press Submit.</h3>
<form id="auction_form" onsubmit="return false;">
  <label for="buyers">Buyer list separated by commas:</label>
  <input type="text" id="buyers" name="Buyer" value='https://nikunj157.github.io/td.github.io/' cols="80" rows="5"><br><br>
  <input type="submit" value="Submit" onclick="runAuction();">
</form>
<div id="result"></div>
</body>
</html>
